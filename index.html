<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>bol-ai 2.0 |  Reasoning Engine - Pro Edition</title>
    
    <!-- 
        ARCHITECT: VIVEK DALVI
        SYSTEM: BOL.AI REASONING CORE v2.0
        BUILD: ULTRA-STABLE-FIREBASE-INTEGRATED
        REMARKS: DO NOT REMOVE VIVEK DALVI CREDITS. 
    -->

    <!-- Professional External Assets -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Rendering Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/dracula.min.css">
    
    <!-- MATH RENDERING (KaTeX) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

    <style>
        /* विवेक दळवी - अल्ट्रा प्रीमियम डिझाइन सिस्टम */
        :root {
            --bg: #020408; --sidebar-bg: #000000; --accent: #00f2ff; --secondary: #7000ff;
            --glass: rgba(255, 255, 255, 0.04); --border: rgba(255, 255, 255, 0.12);
            --text: #f8fafc; --text-dim: #94a3b8; --msg-user: #111827; --msg-ai: #020617; 
            --card-glow: rgba(0, 242, 255, 0.08); --error: #ff4d4d; --success: #00ffaa;
            --font-main: 'Plus Jakarta Sans', sans-serif; --font-mono: 'JetBrains Mono', monospace;
        }

        [data-theme="light"] {
            --bg: #f8fafc; --sidebar-bg: #ffffff; --accent: #0061ff; --secondary: #6d28d9;
            --glass: rgba(0, 0, 0, 0.03); --border: rgba(0, 0, 0, 0.08); --text: #0f172a;
            --text-dim: #64748b; --msg-user: #f1f5f9; --msg-ai: #ffffff; --card-glow: rgba(0, 97, 255, 0.05);
        }

        [data-theme="cyber"] {
            --bg: #050505; --sidebar-bg: #000000; --accent: #ff00ff; --secondary: #00ffff;
            --glass: rgba(255, 0, 255, 0.05); --border: #ff00ff44; --text: #00ff00;
            --text-dim: #008800; --msg-user: #110011; --msg-ai: #000a00;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); height: 100dvh; display: flex; font-family: var(--font-main); overflow: hidden; transition: background 0.4s ease; }

        /* Sidebar Architecture */
        #sidebar { 
            width: 300px; background: var(--sidebar-bg); border-right: 1px solid var(--border); 
            display: flex; flex-direction: column; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 5000; position: relative;
        }
        @media (max-width: 768px) { 
            #sidebar { position: fixed; left: 0; transform: translateX(-100%); height: 100%; } 
            #sidebar.open { transform: translateX(0); box-shadow: 20px 0 50px rgba(0,0,0,0.8); } 
        }

        .sidebar-header { padding: 25px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.6rem; font-weight: 800; background: linear-gradient(90deg, var(--accent), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: -1.5px; }

        .btn-new-chat { margin: 15px; padding: 12px; border: 1.5px solid var(--accent); border-radius: 12px; background: transparent; color: var(--accent); cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 0.85rem; transition: 0.3s; justify-content: center; }
        .btn-new-chat:hover { background: var(--accent); color: #000; box-shadow: 0 0 20px var(--card-glow); }

        .history-container { flex: 1; overflow-y: auto; padding: 10px; scrollbar-width: thin; }
        .history-item { 
            padding: 12px 15px; border-radius: 10px; font-size: 0.85rem; color: var(--text-dim); display: flex; 
            align-items: center; justify-content: space-between; cursor: pointer; margin-bottom: 5px; transition: 0.2s;
        }
        .history-item:hover { background: var(--glass); color: var(--accent); }
        .del-btn { opacity: 0; color: var(--error); transition: 0.2s; padding: 5px; }
        .history-item:hover .del-btn { opacity: 1; }

        /* Main System UI */
        #main-content { flex: 1; display: flex; flex-direction: column; background: var(--bg); position: relative; width: 100%; }
        header { padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); backdrop-filter: blur(15px); }

        /* Selection Slider - vivek dalvi's request */
        .slider-nav { 
            display: flex; gap: 12px; padding: 10px 20px; overflow-x: auto; 
            scrollbar-width: none; border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.1);
            align-items: center;
        }
        .slider-nav::-webkit-scrollbar { display: none; }
        .slider-item { flex: 0 0 auto; }
        
        .compact-select { 
            background: var(--glass); border: 1px solid var(--border); padding: 8px 15px; 
            border-radius: 10px; color: var(--text); font-size: 0.8rem; font-weight: 600; cursor: pointer; outline: none;
        }
        .hidden-element { display: none !important; }

        /* Chat Engine Styles - Optimized for Small text */
        #chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; scrollbar-width: thin; }
        .msg-wrapper { max-width: 850px; width: 100%; margin: 0 auto; }
        .message { 
            padding: 1rem 1.2rem; border-radius: 18px; line-height: 1.6; font-size: 0.92rem; /* SMALLER TEXT */
            position: relative; word-wrap: break-word; animation: fadeInUp 0.3s ease;
        }
        .ai-msg { background: var(--msg-ai); border: 1px solid var(--border); border-bottom-left-radius: 4px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .user-msg { background: var(--msg-user); border: 1px solid var(--accent); align-self: flex-end; border-bottom-right-radius: 4px; float: right; }
        
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Enhanced Code Blocks */
        pre { margin: 15px 0; border-radius: 12px; border: 1px solid var(--border); background: #0d1117 !important; }
        .code-banner { display: flex; justify-content: space-between; padding: 8px 15px; background: rgba(255,255,255,0.05); border-bottom: 1px solid var(--border); font-family: var(--font-mono); font-size: 0.75rem; color: var(--accent); }

        /* Thinking Indicator */
        .reasoning-box { display: none; gap: 10px; align-items: center; padding: 10px 20px; border-radius: 30px; background: var(--glass); width: fit-content; margin: 10px auto; border: 1px solid var(--accent); }
        .dot-loader { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; animation: bounce 0.6s infinite alternate; }
        @keyframes bounce { to { transform: translateY(-5px); opacity: 0.3; } }

        /* Compact Input Area */
        .input-section { padding: 15px 20px; background: var(--bg); border-top: 1px solid var(--border); }
        .input-container { 
            max-width: 850px; margin: 0 auto; display: flex; background: var(--sidebar-bg); 
            border: 1.5px solid var(--border); border-radius: 18px; padding: 10px 18px; gap: 12px; align-items: flex-end; transition: 0.3s;
        }
        .input-container:focus-within { border-color: var(--accent); box-shadow: 0 0 20px var(--card-glow); }
        textarea { flex: 1; background: transparent; border: none; color: var(--text); outline: none; resize: none; min-height: 24px; max-height: 200px; font-size: 0.95rem; padding: 5px 0; }
        .btn-send { background: var(--accent); color: #000; border: none; width: 42px; height: 42px; border-radius: 12px; cursor: pointer; transition: 0.3s; display: grid; place-items: center; }
        .btn-send:hover { transform: scale(1.05); filter: brightness(1.2); }

        /* Modals & Overlays */
        #modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(10px); z-index: 6000; }
        .pro-modal { 
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            width: 90%; max-width: 600px; background: var(--sidebar-bg); border: 1px solid var(--accent); 
            padding: 40px; border-radius: 25px; z-index: 6100; box-shadow: 0 0 50px var(--card-glow);
        }
        .pro-modal h2 { font-size: 2rem; color: var(--accent); margin-bottom: 20px; }
        .pro-modal p { line-height: 1.8; color: var(--text-dim); margin-bottom: 15px; font-size: 0.95rem; }
        .close-x { position: absolute; top: 20px; right: 20px; font-size: 1.5rem; cursor: pointer; }

        /* Maintenance Layer */
        #maintenance { display: none; position: fixed; inset: 0; background: #000; z-index: 10000; flex-direction: column; align-items: center; justify-content: center; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }
    </style>
</head>
<body data-theme="dark">

    <div id="maintenance">
        <div class="logo" style="font-size: 4rem;">bol-ai</div>
        <p style="margin-top: 20px; color: var(--accent); font-weight: 800;">CORE REASONING UPGRADE IN PROGRESS</p>
        <p style="color: gray;">Vivek Dalvi is optimizing logic circuits...</p>
    </div>

    <div id="modal-overlay" onclick="closeAllModals()"></div>

    <!-- Sidebar -->
    <aside id="sidebar">
        <div class="sidebar-header">
            <span class="logo">bol-ai 2.0</span>
            <i class="fas fa-times" style="cursor:pointer; font-size: 1.2rem;" onclick="toggleSidebar()"></i>
        </div>
        <button class="btn-new-chat" onclick="startFreshSession()">
            <i class="fas fa-plus"></i> NEW LOGIC SESSION
        </button>
        <div class="history-container" id="history-list"></div>
        <div style="padding: 15px; border-top: 1px solid var(--border);">
            <div class="history-item" onclick="showModal('m-about')"><i class="fas fa-info-circle"></i> About</div>
            <div class="history-item" onclick="showModal('m-privacy')"><i class="fas fa-shield-halved"></i> Privacy</div>
            <div class="history-item" onclick="showModal('m-contact')"><i class="fas fa-envelope"></i> Contact</div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main id="main-content">
        <header>
            <div style="display:flex; align-items:center; gap:15px">
                <i class="fas fa-bars-staggered" style="font-size: 1.4rem; cursor: pointer;" onclick="toggleSidebar()"></i>
                <div class="logo">bol-ai</div>
            </div>
            <div style="display:flex; gap:15px; align-items:center">
                <i class="fas fa-cloud-arrow-up" style="cursor:pointer; color:var(--accent);" onclick="syncWithFirebase()" title="Cloud Sync"></i>
                <i class="fas fa-bookmark" style="cursor:pointer; color:var(--text-dim);" onclick="saveSnapshot()" title="Save Session"></i>
            </div>
        </header>

        <!-- Slider Navigation for Selectors -->
        <nav class="slider-nav">
            <div class="slider-item">
                <select id="langPicker" class="compact-select">
                    <option value="English">English</option><option value="Hindi">Hindi (हिंदी)</option><option value="Marathi">Marathi (मराठी)</option>
                    <option value="Sanskrit">Sanskrit (संस्कृतम्)</option><option value="Konkani">Konkani (कोंकणी)</option><option value="Spanish">Spanish</option>
                    <option value="French">French</option><option value="German">German</option><option value="Japanese">Japanese</option>
                    <option value="Russian">Russian</option><option value="Bengali">Bengali</option><option value="Telugu">Telugu</option>
                    <option value="Tamil">Tamil</option><option value="Gujarati">Gujarati</option><option value="Kannada">Kannada</option>
                    <option value="Urdu">Urdu</option><option value="Nepali">Nepali</option><option value="Arabic">Arabic</option>
                    <option value="Korean">Korean</option><option value="Portuguese">Portuguese</option><option value="Turkish">Turkish</option>
                    <option value="Vietnamese">Vietnamese</option><option value="Italian">Italian</option><option value="Dutch">Dutch</option>
                    <option value="Greek">Greek</option><option value="Swedish">Swedish</option><option value="Kashmiri">Kashmiri</option>
                    <option value="Sindhi">Sindhi</option><option value="Dogri">Dogri</option><option value="Santali">Santali</option>
                    <option value="Maithili">Maithili</option><option value="Bodo">Bodo</option><option value="Manipuri">Manipuri</option>
                    <option value="Malay">Malay</option><option value="Finnish">Finnish</option><option value="Polish">Polish</option>
                    <option value="Hebrew">Hebrew</option><option value="Thai">Thai</option><option value="Indonesian">Indonesian</option>
                    <option value="Czech">Czech</option><option value="Hungarian">Hungarian</option><option value="Slovak">Slovak</option>
                </select>
            </div>
            <div class="slider-item">
                <select onchange="setTheme(this.value)" class="compact-select">
                    <option value="dark">Dark</option>
                    <option value="light">Light</option>
                    <option value="cyber">Cyber</option>
                </select>
            </div>
            <!-- Hidden Vivek's Server Option -->
            <div class="slider-item hidden-element">
                <select class="compact-select"><option>Vivek's Private Server</option></select>
            </div>
            <div class="slider-item">
                <div class="compact-select" style="background: var(--accent); color: #000;" onclick="alert('bol-ai reasoning Active')">Pro Active</div>
            </div>
        </nav>

        <div id="chat-container">
            <div class="msg-wrapper">
                <div class="message ai-msg">
                    <p><b>Welcome to bol-ai 2.0 .</b></p>
                    <p style="font-size: 0.8rem; margin-top: 5px;">Engineered by Vivek Dalvi. This system uses dynamic logic gates and Firebase-injected code execution for ultra-fast response.</p>
                </div>
            </div>
        </div>

        <div class="input-section">
            <div class="reasoning-box" id="reasoning-ui">
                <div class="dot-loader"></div>
                <span style="font-size: 0.75rem; font-weight: 800; color: var(--accent); letter-spacing: 1px;">VIVEK'S CORE REASONING...</span>
            </div>
            <div class="input-container">
                <textarea id="userInput" placeholder="Ask anything ..." rows="1" oninput="resizer(this)"></textarea>
                <button class="btn-send" onclick="handleLogicFlow()"><i class="fas fa-bolt-lightning"></i></button>
            </div>
            <div style="text-align: center; margin-top: 10px; font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 2px;">
                Created by Vivek Dalvi | © 2025 bol-ai <p> All Rights Reserved</p>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div class="pro-modal" id="m-about">
        <span class="close-x" onclick="closeAllModals()">&times;</span>
        <h2>About bol-ai</h2>
        <p><b>bol-ai</b> is a next-generation Global Reasoning Engine designed by <b>Vivek Dalvi</b>. It bridges the gap between static code and dynamic AI reasoning.</p>
        <p>Version 2.0 introduces Firebase Custom Logic (FCL), allowing the system to execute live code snippets for real-time data processing without hitting API limits.</p>
    </div>

    <div class="pro-modal" id="m-privacy">
        <span class="close-x" onclick="closeAllModals()">&times;</span>
        <h2>Logic Privacy</h2>
        <p>Your logic is yours. Vivek Dalvi has ensured that bol-ai does not store personal query logs on central servers. All "Session Snapshots" are encrypted and stored in your browser's LocalStorage or your private Firebase instance.</p>
    </div>

    <div class="pro-modal" id="m-contact">
        <span class="close-x" onclick="closeAllModals()">&times;</span>
        <h2>System Support</h2>
        <p>For technical queries or developer access:</p>
        <div style="padding: 15px; background: var(--glass); border-radius: 10px; font-family: var(--font-mono); color: var(--accent);">
            vcoder7311@gmail.com
        </div>
    </div>

    <!-- Firebase System -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <script>
        // Vivek Dalvi - Firebase Master Configuration
        const firebaseConfig = { 
            databaseURL: "https://bol-ai-d94f4-default-rtdb.firebaseio.com", 
            projectId: "bol-ai-d94f4" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let globalLogic = {}; // Stores Firebase-injected HTML/JS
        let chatContext = [];

        // Initializing Firebase Listeners for Dynamic Logic
        db.ref('custom_logic').on('value', snap => {
            globalLogic = snap.val() || {};
            console.log("Vivek's Logic Gates Loaded:", Object.keys(globalLogic));
        });

        db.ref('settings').on('value', snap => {
            const s = snap.val();
            if(s && s.maintenance_mode) {
                document.getElementById('maintenance').style.display = 'flex';
            } else {
                document.getElementById('maintenance').style.display = 'none';
            }
        });

        // The Logic Flow Handler (Smart Switch)
        async function handleLogicFlow() {
            const inputField = document.getElementById('userInput');
            const query = inputField.value.trim();
            if(!query) return;

            // 1. Append User Message
            drawMessage('user', query);
            inputField.value = '';
            inputField.style.height = '45px';
            
            // Show Thinking
            const loader = document.getElementById('reasoning-ui');
            loader.style.display = 'flex';

            // 2. CHECK DYNAMIC FIREBASE LOGIC (Local Injection)
            // Example: If user says "time", and logic exists in Firebase for "time"
            let handledLocally = false;
            for (let key in globalLogic) {
                if (query.toLowerCase().includes(key)) {
                    executeInjectedLogic(globalLogic[key]);
                    handledLocally = true;
                    break;
                }
            }

            if (handledLocally) {
                loader.style.display = 'none';
                return;
            }

            // 3. IF NOT LOCAL, CALL AI CLOUD
            const lang = document.getElementById('langPicker').value;
            const systemPrompt = `You are bol-ai 2.0 by Vivek Dalvi. Use LaTeX for math. Be concise. Reply in ${lang}.`;

            try {
                const response = await fetch("/api/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        message: query, 
                        system: systemPrompt, 
                        history: chatContext.slice(-6) 
                    })
                });

                const data = await response.json();
                loader.style.display = 'none';

                if(data.choices) {
                    const aiText = data.choices[0].message.content;
                    renderAITypewriter(aiText);
                    chatContext.push({role: 'user', content: query}, {role: 'assistant', content: aiText});
                } else {
                    drawMessage('ai', "Cloud connection unstable. Re-routing through Vivek's backup...");
                }
            } catch (err) {
                loader.style.display = 'none';
                drawMessage('ai', "Error: Logic Core disconnected. Check Vercel/GitHub status.");
            }
        }

        // Vivek's Injected Logic Executor
        function executeInjectedLogic(codeSnippet) {
            // codeSnippet can be a string like "return 'Current time is ' + new Date().toLocaleTimeString()"
            try {
                // We use a safe-ish way to execute logic
                const result = new Function(codeSnippet)();
                renderAITypewriter(result || "Logic executed successfully.");
            } catch(e) {
                drawMessage('ai', "Injected code error. Check Firebase syntax.");
            }
        }

        // High-Speed Typewriter Effect
        function renderAITypewriter(text) {
            const container = document.getElementById('chat-container');
            const wrap = document.createElement('div'); wrap.className = 'msg-wrapper';
            const msgDiv = document.createElement('div'); msgDiv.className = 'message ai-msg';
            wrap.appendChild(msgDiv); container.appendChild(wrap);

            let charIdx = 0;
            const speed = 30; 
            const timer = setInterval(() => {
                msgDiv.innerHTML = marked.parse(text.substring(0, charIdx) + "▊");
                charIdx += 4;
                if(charIdx >= text.length + 4) {
                    clearInterval(timer);
                    msgDiv.innerHTML = marked.parse(text);
                    postProcessMath(msgDiv);
                    container.scrollTop = container.scrollHeight;
                }
            }, 10);
        }

        function drawMessage(role, text) {
            const container = document.getElementById('chat-container');
            const wrap = document.createElement('div'); wrap.className = 'msg-wrapper';
            wrap.innerHTML = `<div class="message ${role}-msg">${marked.parse(text)}</div>`;
            container.appendChild(wrap);
            postProcessMath(wrap);
            container.scrollTop = container.scrollHeight;
        }

        function postProcessMath(el) {
            renderMathInElement(el, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError : false
            });
            el.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
                if (!block.parentElement.querySelector('.code-banner')) {
                    const b = document.createElement('div');
                    b.className = 'code-banner';
                    b.innerHTML = `<span>LOGIC_OUTPUT</span><i class="fas fa-copy" style="cursor:pointer" onclick="copyCode(this)"></i>`;
                    block.parentElement.prepend(b);
                }
            });
        }

        // UI Helpers
        function resizer(el) { el.style.height = '24px'; el.style.height = (el.scrollHeight) + 'px'; }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        function showModal(id) { 
            document.getElementById('modal-overlay').style.display = 'block'; 
            document.getElementById(id).style.display = 'block'; 
        }
        function closeAllModals() { 
            document.querySelectorAll('.pro-modal, #modal-overlay').forEach(m => m.style.display = 'none'); 
        }
        function setTheme(v) { document.body.setAttribute('data-theme', v); }
        function copyCode(btn) {
            const code = btn.closest('pre').querySelector('code').innerText;
            navigator.clipboard.writeText(code);
            btn.className = "fas fa-check";
            setTimeout(() => btn.className = "fas fa-copy", 2000);
        }

        function startFreshSession() {
            chatContext = [];
            document.getElementById('chat-container').innerHTML = '<div class="msg-wrapper"><div class="message ai-msg">Logic session cleared. Ready for new input.</div></div>';
            if(window.innerWidth < 768) toggleSidebar();
        }

        // Snapshot Logic - LocalStorage
        function saveSnapshot() {
            if(chatContext.length === 0) return;
            const name = prompt("Enter Logic Label:");
            if(!name) return;
            const history = JSON.parse(localStorage.getItem('bol_history') || '[]');
            history.push({ id: Date.now(), title: name, data: chatContext });
            localStorage.setItem('bol_history', JSON.stringify(history));
            renderHistoryList();
        }

        function renderHistoryList() {
            const list = document.getElementById('history-list');
            const history = JSON.parse(localStorage.getItem('bol_history') || '[]');
            list.innerHTML = "";
            history.slice().reverse().forEach(item => {
                const d = document.createElement('div');
                d.className = 'history-item';
                d.innerHTML = `<span><i class="fas fa-microchip"></i> ${item.title}</span><i class="fas fa-trash-can del-btn" onclick="deleteLogic(${item.id}, event)"></i>`;
                d.onclick = () => {
                    chatContext = item.data;
                    document.getElementById('chat-container').innerHTML = "";
                    chatContext.forEach(m => drawMessage(m.role === 'user' ? 'user' : 'ai', m.content));
                    if(window.innerWidth < 768) toggleSidebar();
                };
                list.appendChild(d);
            });
        }

        function deleteLogic(id, e) {
            e.stopPropagation();
            let history = JSON.parse(localStorage.getItem('bol_history') || '[]');
            history = history.filter(h => h.id !== id);
            localStorage.setItem('bol_history', JSON.stringify(history));
            renderHistoryList();
        }

        window.onload = renderHistoryList;
    </script>
</body>
</html>
